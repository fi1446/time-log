- if flash[:notice]
  - flash[:notice].values.each do |a|
    = a.first
    %br
= l @date, format: :date
%br
合計時間:
= total_time_from_tasks(@tasks, @date) || 'まだタスクが登録されていません。'
%br
- @tasks.each do |task|
  = task.memo
  = time_format_from_task(task)
  = show_time_range(task)
  - if task.tag_id
    = Tag.find(task.tag_id).name
  = link_to '[X]', task_path(id: task.id, date: @date), method: :delete
  %br
= form_for @task, url: tasks_path do |f|
  = f.text_field :memo
  = f.text_field :starts_at, class: 'task_starts_at'
  = f.text_field :ends_at, class: 'task_ends_at'
  = f.hidden_field :year, value: params[:year]
  = f.hidden_field :month, value: params[:month]
  = f.hidden_field :day, value: params[:day]
  = f.select :tag_id, current_user.tags.all.collect { |t| [t.name, t.id] }, include_blank: true
  = f.submit
%br
= link_to '一覧へ戻る', tasks_months_path(year: @date.year, month: @date.month)

%link{rel: "stylesheet", href: "//code.jquery.com/ui/1.11.3/themes/smoothness/jquery-ui.css"}
%link{rel: "stylesheet", href: "//jonthornton.github.io/jquery-timepicker/jquery.timepicker.css"}
%script{src: "//code.jquery.com/jquery-1.10.2.js"}
%script{src: "//code.jquery.com/ui/1.11.3/jquery-ui.js"}
%script{src: "//jonthornton.github.io/jquery-timepicker/jquery.timepicker.js"}
= set_time_select_to_now(Time.zone.now)
:javascript
  $(document).ready(function(){
    $('.task_starts_at').timepicker({
      step: 10
    }).val('#{set_time_select_to_now(Time.zone.now)}');
  });
  $(document).ready(function(){
    $('.task_ends_at').timepicker({
      step: 10
    }).val('#{set_time_select_to_now(Time.zone.now)}');
  });
